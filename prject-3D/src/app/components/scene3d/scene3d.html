<div class="scene-container" [class.sidebar-open]="showTestModal">
  <div #canvasContainer class="canvas-container"></div>
  <div class="controls-info">
    <h3>ModÃ©lisation</h3>
    
    <div class="controls-section">
      <h4>ContrÃ´les</h4>
      <button class="reset-button" (click)="resetCameraPosition()">RÃ©initialiser</button>
      <button class="legend-button" (click)="openLegendModal()">Voir la lÃ©gende</button>
      <button class="test-button" (click)="openTestModal()">ğŸ§ª Test des Services</button>
      
      <h4>ContrÃ´les Souris</h4>
      <ul>
        <li><strong>Clic + Glisser</strong> : Rotation autour de la construction</li>
        <li><strong>Molette</strong> : Zoom avant/arriÃ¨re (5-50)</li>
        <li><strong>Clic droit</strong> : DÃ©sactivÃ©</li>
      </ul>
    </div>

    <!-- <div class="specs-section">
      <h4>Couleurs</h4>
      <ul>
        <li>ğŸ”˜ Murs : Gris</li>
        <li>ğŸŸ¢ Porte : Vert</li>
        <li>ğŸ”´ FenÃªtres : Rouge</li>
      </ul>
    </div> -->

    <!-- <div class="dimensions-section">
      <h4>Dimensions</h4>
      <ul>
        <li>Hauteur des murs : 2.5m</li>
        <li>Ã‰paisseur : 0.20m</li>
      </ul>
    </div> -->
  </div>

  <!-- Modale de lÃ©gende -->
  <div class="modal-overlay" [class.show]="showLegendModal" (click)="closeLegendModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>LÃ©gende de la ModÃ©lisation 3D</h2>
        <button class="close-button" (click)="closeLegendModal()">&times;</button>
      </div>
      
      <div class="modal-body">
        <div class="legend-section">
          <h3>Architecture du BÃ¢timent</h3>
          <div class="building-info">
            <div class="info-card">
              <h4>Dimensions GÃ©nÃ©rales</h4>
              <ul>
                <li><strong>Longueur :</strong> 8 m</li>
                <li><strong>Largeur :</strong> 5 m</li>
                <li><strong>Hauteur :</strong> 2.5 m</li>
                <li><strong>Ã‰paisseur des murs :</strong> 0.20 m</li>
              </ul>
            </div>
            
            <div class="info-card">
              <h4>Ã‰lÃ©ments Structurels</h4>
              <ul>
                <li><strong>Sol :</strong> Plateforme de base (8m Ã— 5m Ã— 0.20m)</li>
                <li><strong>Toit :</strong> Couverture (8.4m Ã— 5m Ã— 0.20m)</li>
                <li><strong>Murs :</strong> 4 murs formant un rectangle</li>
              </ul>
            </div>
          </div>
        </div>

        <div class="legend-section">
          <h3>Ouvertures et AccÃ¨s</h3>
          <div class="openings-info">
            <div class="opening-card door">
              <div class="opening-icon">ğŸšª</div>
              <div class="opening-details">
                <h4>Porte d'EntrÃ©e</h4>
                <ul>
                  <li><strong>Position :</strong> Mur principal </li>
                  <li><strong>Dimensions :</strong> 1m Ã— 2.1m</li>
                  <li><strong>Couleur :</strong> Vert</li>
                  <li><strong>Epaisseur:</strong> 0.05m</li>
                </ul>
              </div>
            </div>

            <div class="opening-card window">
              <div class="opening-icon">ğŸªŸ</div>
              <div class="opening-details">
                <h4>FenÃªtre 1</h4>
                <ul>
                  <li><strong>Position :</strong> Mur principal (faÃ§ade)</li>
                  <li><strong>Dimensions :</strong> 1.5m Ã— 1.2m</li>
                  <li><strong>Couleur :</strong> Rouge</li>
                  <li><strong>Epaisseur:</strong> 0.05m</li>
                </ul>
              </div>
            </div>

            <div class="opening-card window">
              <div class="opening-icon">ğŸªŸ</div>
              <div class="opening-details">
                <h4>FenÃªtre 2</h4>
                <ul>
                  <li><strong>Position :</strong> Mur principal (faÃ§ade)</li>
                  <li><strong>Dimensions :</strong> 2m Ã— 1.2m</li>
                  <li><strong>Couleur :</strong> Rouge</li>
                  <li><strong>Epaisseur:</strong> 0.05m</li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="legend-section">
          <h3>Code Couleurs</h3>
          <div class="color-legend">
            <div class="color-item">
              <div class="color-box color-walls"></div>
              <span><strong>Murs :</strong> Gris clair (#aaaaaa)</span>
            </div>
            <div class="color-item">
              <div class="color-box color-door"></div>
              <span><strong>Porte :</strong> Vert (#00ff00)</span>
            </div>
            <div class="color-item">
              <div class="color-box color-windows"></div>
              <span><strong>FenÃªtres :</strong> Rouge (#ff0000)</span>
            </div>
            <div class="color-item">
              <div class="color-box color-ground"></div>
              <span><strong>Sol :</strong> Marron foncÃ© (#2E1E1A)</span>
            </div>
            <div class="color-item">
              <div class="color-box color-roof"></div>
              <span><strong>Toit :</strong> Bleu royal (#4169e1)</span>
            </div>
          </div>
        </div>

        <div class="legend-section">
          <h3> ContrÃ´les de Navigation</h3>
          <div class="controls-legend">
            <div class="control-item">
              <div class="control-icon">ğŸ–±ï¸</div>
              <div class="control-text">
                <strong>Clic + Glisser :</strong> Rotation autour du bÃ¢timent
              </div>
            </div>
            <div class="control-item">
              <div class="control-icon">ğŸ¯</div>
              <div class="control-text">
                <strong>Molette :</strong> Zoom avant/arriÃ¨re (5-50 unitÃ©s)
              </div>
            </div>
            <div class="control-item">
              <div class="control-icon">ğŸ”„</div>
              <div class="control-text">
                <strong>Bouton RÃ©initialiser :</strong> Retour Ã  la vue initiale
              </div>
            </div>
          </div>
        </div>

        <div class="legend-section">
          <h3>ğŸ“ SystÃ¨me de CoordonnÃ©es</h3>
          <div class="coordinates-info">
            <div class="axis-info">
              <div class="axis-color axis-x"></div>
              <span><strong>Axe X (Rouge) :</strong> Gauche/Droite</span>
            </div>
            <div class="axis-info">
              <div class="axis-color axis-y"></div>
              <span><strong>Axe Y (Vert) :</strong> Bas/Haut</span>
            </div>
            <div class="axis-info">
              <div class="axis-color axis-z"></div>
              <span><strong>Axe Z (Bleu) :</strong> Avant/ArriÃ¨re</span>
            </div>
          </div>
        </div>

        <div class="legend-section">
          <h3>ğŸ’¡ Techniques UtilisÃ©es</h3>
          <div class="tech-info">
            <div class="tech-card">
              <h4>Three.js</h4>
              <p>BibliothÃ¨que JavaScript pour la crÃ©ation de graphiques 3D dans le navigateur</p>
            </div>
            <div class="tech-card">
              <h4>ExtrudeGeometry</h4>
              <p>Technique utilisÃ©e pour crÃ©er de vraies ouvertures dans les murs (trous)</p>
            </div>
            <div class="tech-card">
              <h4>Configuration CentralisÃ©e</h4>
              <p>Toutes les dimensions et couleurs sont dÃ©finies dans un fichier de configuration (building-config.ts)</p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="modal-footer">
        <button class="close-modal-btn" (click)="closeLegendModal()">Fermer</button>
      </div>
    </div>
  </div>
</div>


<!-- Sidebar de test des services -->
<div class="sidebar-overlay" [class.show]="showTestModal" (click)="closeTestModal($event)">
  <div class="sidebar-content test-sidebar" (click)="$event.stopPropagation()">
    <div class="sidebar-header">
      <h2> Test des Services</h2>
      <button class="sidebar-close" (click)="closeTestModal($event)">Ã—</button>
    </div>
    <div class="sidebar-body">
      <!-- Section des tests de base -->
      <div class="test-section">
        <h3>Tests de Base</h3>
        <div class="test-buttons">
          <button (click)="testStatistiques()" class="btn-test btn-blue">
            <div class="btn-icon"></div>
            <div class="btn-label">Statistiques</div>
          </button>
          <button (click)="testExport()" class="btn-test btn-purple">
            <div class="btn-icon"></div>
            <div class="btn-label">Export</div>
          </button>
          <button (click)="testValidation()" class="btn-test btn-red">
            <div class="btn-icon"></div>
            <div class="btn-label">Synchroniser</div>
          </button>
        </div>
      </div>

      <!-- Section des tests de couleurs automatiques -->
      <div class="test-section">
        <h3> Tests de Couleurs Automatiques</h3>
        <!-- <div class="test-buttons">
          <button (click)="testCouleurs()" class="btn-test btn-orange">
            <div class="btn-icon"></div>
            <div class="btn-label">Couleurs Murs</div>
          </button>
          <button (click)="testCouleursOuvertures()" class="btn-test btn-cyan">
            <div class="btn-icon"></div>
            <div class="btn-label">Couleurs Ouvertures</div>
          </button>
        </div> -->
      </div>

      <!-- Section du sÃ©lecteur de couleurs interactif -->
      <div class="test-section">
        <h3> SÃ©lecteur de Couleurs Interactif</h3>
        
        <!-- SÃ©lecteur de couleurs -->
        <div class="color-picker-section">
          <div class="color-picker-container">
            <label for="colorPicker">Choisir une couleur :</label>
            <div class="color-input-group">
              <input type="color" id="colorPicker" [(ngModel)]="selectedColor" (change)="onColorChange()" class="color-picker">
              <span class="color-value">{{selectedColor}}</span>
            </div>
          </div>
        </div>

        <!-- SÃ©lection des Ã©lÃ©ments -->
        <div class="element-selection-section">
          <div class="element-group">
            <h4> Murs</h4>
            <div class="element-buttons">
              <button (click)="changeElementColor('principal')" class="btn-element" [class.active]="selectedElement === 'principal'">
                <div class="element-icon"></div>
                <div class="element-label">Mur Principal</div>
              </button>
              <button (click)="changeElementColor('arriere')" class="btn-element" [class.active]="selectedElement === 'arriere'">
                <div class="element-icon"></div>
                <div class="element-label">Mur ArriÃ¨re</div>
              </button>
              <button (click)="changeElementColor('gauche')" class="btn-element" [class.active]="selectedElement === 'gauche'">
                <div class="element-icon"></div>
                <div class="element-label">Mur Gauche</div>
              </button>
              <button (click)="changeElementColor('droit')" class="btn-element" [class.active]="selectedElement === 'droit'">
                <div class="element-icon"></div>
                <div class="element-label">Mur Droit</div>
              </button>
            </div>
          </div>

          <div class="element-group">
            <h4> Ouvertures</h4>
            <div class="element-buttons">
              <button (click)="changeElementColor('fenetre2')" class="btn-element" [class.active]="selectedElement === 'fenetre2'">
                <div class="element-icon"></div>
                <div class="element-label">FenÃªtre Principale</div>
    </button>
              <button (click)="changeElementColor('fenetre3')" class="btn-element" [class.active]="selectedElement === 'fenetre3'">
                <div class="element-icon"></div>
                <div class="element-label">FenÃªtre ArriÃ¨re</div>
    </button>
              <button (click)="changeElementColor('porte1')" class="btn-element" [class.active]="selectedElement === 'porte1'">
                <div class="element-icon"></div>
                <div class="element-label">Porte d'EntrÃ©e</div>
    </button>
            </div>
          </div>
  </div>
  
        <!-- Actions -->
        <div class="color-actions-section">
          <button (click)="resetAllColors()" class="btn-reset">
            <div class="btn-icon"></div>
            <div class="btn-text">Remettre les couleurs originales</div>
    </button>
        </div>
      </div>

      <!-- Section de communication -->
      <div class="test-section">
        <h3>ğŸ“¡ Communication</h3>
        <div class="test-buttons">
          <button (click)="testCommunication()" class="btn-test btn-gray">
            <div class="btn-icon">ğŸ“¡</div>
            <div class="btn-label">Communication</div>
          </button>
          <button (click)="testMateriaux()" class="btn-test btn-purple">
            <div class="btn-icon">ğŸ¨</div>
            <div class="btn-label">MatÃ©riaux</div>
          </button>
          <button (click)="testScene()" class="btn-test btn-indigo">
            <div class="btn-icon">ğŸ¬</div>
            <div class="btn-label">ScÃ¨ne 3D</div>
          </button>
          <button (click)="testMurs()" class="btn-test btn-brown">
            <div class="btn-icon">ğŸ§±</div>
            <div class="btn-label">Murs</div>
          </button>
          <button (click)="testModificationsMurs()" class="btn-test btn-orange">
            <div class="btn-icon">ğŸ”§</div>
            <div class="btn-label">Modifications</div>
    </button>
        </div>
  </div>
  
      <!-- SÃ©lecteur de couleurs interactif -->
      <!-- <div class="color-selector-section">
        <h3>ğŸ¨ SÃ©lecteur de Couleurs Interactif</h3>
        
        <div class="color-picker-container">
          <label for="colorPicker">Choisissez une couleur :</label>
          <div class="color-input-group">
            <input 
              type="color" 
              id="colorPicker" 
              class="color-picker"
              [(ngModel)]="selectedColor"
              (change)="onColorChange()"
            >
            <span class="color-value">{{ selectedColor }}</span>
          </div>
        </div>

        <div class="element-selector">
          <h4>Choisissez un Ã©lÃ©ment Ã  colorier :</h4>
          <div class="element-buttons">
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'principal'"
              (click)="changeElementColor('principal')"
            >
              ğŸ§± Mur Principal
            </button>
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'arriere'"
              (click)="changeElementColor('arriere')"
            >
              ğŸ§± Mur ArriÃ¨re
            </button>
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'gauche'"
              (click)="changeElementColor('gauche')"
            >
              ğŸ§± Mur Gauche
            </button>
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'droit'"
              (click)="changeElementColor('droit')"
            >
              ğŸ§± Mur Droit
            </button>
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'fenetre2'"
              (click)="changeElementColor('fenetre2')"
            >
              ğŸªŸ FenÃªtre Principale
            </button>
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'fenetre3'"
              (click)="changeElementColor('fenetre3')"
            >
              ğŸªŸ FenÃªtre ArriÃ¨re
            </button>
            <button 
              class="btn-element" 
              [class.active]="selectedElement === 'porte1'"
              (click)="changeElementColor('porte1')"
            >
              ğŸšª Porte d'EntrÃ©e
            </button>
          </div>
        </div>

        <div class="color-actions">
          <button (click)="resetAllColors()" class="btn-reset">
            ğŸ”„ Remettre Ã  zÃ©ro
          </button>
        </div>
      </div> -->

      <!-- Modificateur de murs interactif -->
      <div class="mur-modifier-section">
        <h3>ğŸ”§ Modificateur de Murs Interactif</h3>
        
        <div class="mur-selector">
          <h4>Choisissez un mur Ã  modifier :</h4>
          <div class="mur-buttons">
            <button 
              class="btn-mur" 
              [class.active]="selectedMur === 'principal'"
              (click)="selectMur('principal')"
            >
              ğŸ§± Mur Principal
            </button>
            <button 
              class="btn-mur" 
              [class.active]="selectedMur === 'arriere'"
              (click)="selectMur('arriere')"
            >
              ğŸ§± Mur ArriÃ¨re
            </button>
            <button 
              class="btn-mur" 
              [class.active]="selectedMur === 'gauche'"
              (click)="selectMur('gauche')"
            >
              ğŸ§± Mur Gauche
            </button>
            <button 
              class="btn-mur" 
              [class.active]="selectedMur === 'droit'"
              (click)="selectMur('droit')"
            >
              ğŸ§± Mur Droit
            </button>
          </div>
        </div>

        <div class="mur-properties" *ngIf="selectedMur">
          <h4>PropriÃ©tÃ©s du {{ selectedMur === 'principal' ? 'Mur Principal' : selectedMur === 'arriere' ? 'Mur ArriÃ¨re' : selectedMur === 'gauche' ? 'Mur Gauche' : 'Mur Droit' }} :</h4>
          
          <!-- Position -->
          <div class="property-group">
            <h5>ğŸ“ Position (X, Y, Z) :</h5>
            <div class="input-group">
              <input 
                type="number" 
                [(ngModel)]="murPosition.x" 
                step="0.1" 
                placeholder="X"
                class="number-input"
              >
              <input 
                type="number" 
                [(ngModel)]="murPosition.y" 
                step="0.1" 
                placeholder="Y"
                class="number-input"
              >
              <input 
                type="number" 
                [(ngModel)]="murPosition.z" 
                step="0.1" 
                placeholder="Z"
                class="number-input"
              >
              <button (click)="modifierPositionMur()" class="btn-apply">
                âœ… Appliquer Position
              </button>
            </div>
          </div>

          <!-- Dimensions -->
          <div class="property-group">
            <h5>ğŸ“ Dimensions (Largeur, Hauteur, Profondeur) :</h5>
            <div class="input-group">
              <input 
                type="number" 
                [(ngModel)]="murDimensions.width" 
                step="0.1" 
                placeholder="Largeur"
                class="number-input"
              >
              <input 
                type="number" 
                [(ngModel)]="murDimensions.height" 
                step="0.1" 
                placeholder="Hauteur"
                class="number-input"
              >
              <input 
                type="number" 
                [(ngModel)]="murDimensions.depth" 
                step="0.1" 
                placeholder="Profondeur"
                class="number-input"
              >
              <button (click)="modifierDimensionsMur()" class="btn-apply">
                âœ… Appliquer Dimensions
              </button>
            </div>
          </div>

          <!-- Ã‰paisseur -->
          <div class="property-group">
            <h5>ğŸ“ Ã‰paisseur :</h5>
            <div class="input-group">
              <input 
                type="number" 
                [(ngModel)]="murEpaisseur" 
                step="0.01" 
                placeholder="Ã‰paisseur"
                class="number-input"
              >
              <button (click)="modifierEpaisseurMur()" class="btn-apply">
                âœ… Appliquer Ã‰paisseur
              </button>
            </div>
          </div>

          <!-- Couleur -->
          <div class="property-group">
            <h5>ğŸ¨ Couleur :</h5>
            <div class="input-group">
              <label for="murColorPicker" class="sr-only">SÃ©lecteur de couleur du mur</label>
              <input 
                type="color" 
                id="murColorPicker"
                [(ngModel)]="murCouleur"
                class="color-input"
                title="SÃ©lecteur de couleur du mur"
              >
              <span class="color-display">{{ murCouleur }}</span>
              <button (click)="modifierCouleurMurInteractive()" class="btn-apply">
                âœ… Appliquer Couleur
              </button>
            </div>
          </div>

          <!-- Actions globales -->
          <div class="mur-actions">
            <button (click)="appliquerModificationsMur()" class="btn-apply-all">
              ğŸš€ Appliquer Toutes les Modifications
            </button>
            <button (click)="resetMurValues()" class="btn-reset">
              ğŸ”„ RÃ©initialiser
            </button>
          </div>
        </div>
      </div>

      <!-- Zone de sortie des tests -->
      <div class="test-output-section">
        <h3>ğŸ“Š RÃ©sultats des Tests</h3>
        <div id="services-output" class="test-output">
          <div class="success-message">âœ… Services intÃ©grÃ©s avec succÃ¨s!</div>
    <div>Cliquez sur les boutons pour tester les fonctionnalitÃ©s.</div>
        </div>
      </div>
    </div>
  </div>
</div>
